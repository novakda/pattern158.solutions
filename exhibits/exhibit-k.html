<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light">
    <meta name="description" content="Microsoft MCAPS AI-Led Training Agent: How a hybrid AI/structured-data architecture outperformed the platform vendor's own approach in Copilot Studio.">
    <meta name="author" content="Dan Novak">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://pattern158.solutions/exhibits/exhibit-k.html">
    <meta property="og:title" content="Pattern 158 | Exhibit K: Microsoft MCAPS - Hybrid AI Architecture">
    <meta property="og:description" content="Microsoft MCAPS AI-Led Training Agent: How a hybrid AI/structured-data architecture outperformed the platform vendor's own approach in Copilot Studio.">
    <meta property="og:image" content="https://pattern158.solutions/assets/images/logos/pattern158_logo_3pipes_detailed.png">
    <meta property="og:image:width" content="1024">
    <meta property="og:image:height" content="559">
    <meta property="og:site_name" content="Pattern 158 Solutions">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Theme detection: MUST run before CSS to prevent flash -->
    <script>
    (function() {
        var STORAGE_KEY = 'theme';
        var THEME_ATTR = 'data-theme';
        var prefersDarkQuery = '(prefers-color-scheme: dark)';
        var mql = window.matchMedia(prefersDarkQuery);
        var supportsColorScheme = mql.media === prefersDarkQuery;
        var savedTheme = null;
        try { savedTheme = localStorage.getItem(STORAGE_KEY); } catch (e) {}
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute(THEME_ATTR, 'dark');
        } else if (savedTheme === null && supportsColorScheme && mql.matches) {
            document.documentElement.setAttribute(THEME_ATTR, 'dark');
        }
    })();
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://pattern158.solutions/exhibits/exhibit-k.html">
    <link rel="icon" href="../assets/images/icons/pattern158_favicon_flat.png" type="image/png" sizes="32x32">
    <link rel="icon" href="../assets/images/icons/pattern158_favicon_flat.png" type="image/png" sizes="192x192">
    <link rel="apple-touch-icon" href="../assets/images/icons/pattern158_favicon_flat.png" sizes="180x180">
    <title>Pattern 158 | Exhibit K: Microsoft MCAPS - Hybrid AI Architecture</title>
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Pattern 158 Solutions",
  "description": "Dan Novak's professional portfolio - Systems architecture and legacy system rescue",
  "url": "https://pattern158.solutions"
}
</script>
</head>
<body class="page-exhibit page-exhibit-k">
    <!-- Skip link for keyboard navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Navigation -->
    <nav>
        <div class="container">
            <a href="/index.html" class="logo-link">
                <img src="/assets/images/logos/pattern158_logo_3pipes_detailed.png"
                     alt="Pattern 158 - Provider of Clarity"
                     class="logo-img"
                     width="88"
                     height="48">
            </a>

            <!-- Hamburger button (mobile only) -->
            <button class="hamburger"
                    type="button"
                    aria-expanded="false"
                    aria-controls="nav-menu"
                    aria-label="Toggle navigation menu">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </button>

            <!-- Navigation menu -->
            <ul id="nav-menu" class="nav-menu">
                <li><a href="/index.html">Home</a></li>
                <li><a href="/philosophy.html">Philosophy</a></li>
                <li><a href="/faq.html">FAQ</a></li>
                <li><a href="/technologies.html">Technologies</a></li>
                <li><a href="/portfolio.html">Portfolio</a></li>
                <li><a href="/contact.html">Contact</a></li>
                <li><a href="/testimonials.html">Field Reports</a></li>
                <li>
                    <button id="theme-toggle" class="theme-toggle" type="button"
                            aria-label="Toggle dark mode" aria-pressed="false">
                        <svg class="icon-sun" aria-hidden="true" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                        </svg>
                        <svg class="icon-moon" aria-hidden="true" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                        <span class="sr-only">Toggle dark mode</span>
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">

    <!-- Hero -->
    <section class="hero">
        <div class="container">
            <h1>INVESTIGATION <span class="pattern-number">REPORT</span></h1>
            <p class="subtitle">Exhibit K: Microsoft MCAPS &mdash; Hybrid AI Architecture</p>
            <div class="report-meta">
                <strong>Client:</strong> Microsoft (MCAPS &mdash; sales/partner organization)<br>
                <strong>Platform:</strong> Microsoft Copilot Studio + Teams<br>
                <strong>Period:</strong> 2025&ndash;2026<br>
                <strong>Role:</strong> AI Agent Developer, GP Strategies (contracted by Microsoft)
            </div>
            <span class="classification">Field Report &middot; Exhibit K &middot; Microsoft &middot; 2025&ndash;2026</span>
        </div>
    </section>

    <!-- 1. BACKGROUND -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">1.</span>
                <span class="section-title">Background</span>
            </div>
            <div class="background-content">
                <p>Microsoft MCAPS (their sales and partner organization) brought in outside expertise to evolve their existing AI-Led Training (AILT) concept. Microsoft had built an initial <strong>declarative agent</strong> using a one-shot prompt &mdash; a single system instruction that relied entirely on the LLM to manage course navigation, progress tracking, and assessments through conversation.</p>

                <p>The engagement called for rebuilding it as a proper <span class="key-fact">Copilot Studio</span> implementation that made effective use of the platform&rsquo;s features: topic-based conversation design, structured data flows, and native Teams integration.</p>

                <p>Dan entered the project with <strong>zero Copilot Studio experience</strong> &mdash; brought in for engineering methodology and learning technology domain knowledge, not platform familiarity.</p>

                <p>This was not a cold introduction to Microsoft. GP Strategies had embedded staff on Microsoft accounts since 2015 &mdash; Dan had contributed to the Windows 10 eLearning program, SCORM integration troubleshooting, and the accessibility initiative that earned recognition for &ldquo;moving the bar to better, more accessible courses.&rdquo; The MCAPS engagement built on a decade of institutional trust between GP Strategies and Microsoft.</p>
            </div>
        </div>
    </section>

    <!-- 1b. PERSONNEL -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">1b.</span>
                <span class="section-title">Personnel</span>
            </div>

            <table class="resolution-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Involvement</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Name"><strong>Max Glick</strong></td>
                        <td data-label="Role">Lead Developer, GP Strategies</td>
                        <td data-label="Involvement">Technical lead on the Copilot Studio implementation. Drove overall architecture and delivery.</td>
                    </tr>
                    <tr>
                        <td data-label="Name"><strong>Dan Novak</strong></td>
                        <td data-label="Role">AI Agent Developer, GP Strategies</td>
                        <td data-label="Involvement">R&amp;D, experimentation, and implementation support. Designed and built components, variables, and flows in Copilot Studio. Developed the hybrid AI/structured-data architecture concept.</td>
                    </tr>
                    <tr>
                        <td data-label="Name"><strong>&mdash;</strong></td>
                        <td data-label="Role">Instructional Designer, GP Strategies</td>
                        <td data-label="Involvement">Course content author. Provided training content and learning objectives for the agent.</td>
                    </tr>
                    <tr>
                        <td data-label="Name"><strong>&mdash;</strong></td>
                        <td data-label="Role">Project Manager, GP Strategies</td>
                        <td data-label="Involvement">Microsoft account relationship. Coordinated between GP Strategies development and MCAPS stakeholders.</td>
                    </tr>
                    <tr>
                        <td data-label="Name"><strong>&mdash;</strong></td>
                        <td data-label="Role">MCAPS Program Lead, Microsoft</td>
                        <td data-label="Involvement">Defined training requirements. Originated the AI-Led Training concept and commissioned the rebuild.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- 2. THE PROMPT ENGINEERING CEILING -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">2.</span>
                <span class="section-title">The Prompt Engineering Ceiling</span>
            </div>
            <div class="background-content">
                <p>The core challenge: pure prompt engineering cannot reliably enforce <strong>deterministic state</strong>. A declarative agent can be told &ldquo;track which lessons the user has completed,&rdquo; but LLMs are probabilistic &mdash; they approximate, hallucinate, and lose context across conversation boundaries. For a training application, this is catastrophic:</p>

                <ul class="detail-list">
                    <li>Progress tracking must be <strong>deterministic</strong>, not approximate</li>
                    <li>Course sequence must be <strong>enforced</strong>, not suggested</li>
                    <li>Assessment scores must be <strong>persisted</strong>, not remembered</li>
                    <li>State must survive <strong>across conversation boundaries</strong></li>
                </ul>

                <p>Declarative agents and topic-based conversation design alone couldn&rsquo;t solve this. The LLM was being asked to serve as both the interface <em>and</em> the data store &mdash; a fundamental architectural mistake.</p>
            </div>
        </div>
    </section>

    <!-- 3. THE HYBRID ARCHITECTURE -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">3.</span>
                <span class="section-title">The Hybrid Architecture</span>
            </div>
            <div class="background-content">
                <p>The breakthrough was separating concerns: <strong>structured data for state, AI for interaction</strong>. Instead of asking the LLM to track everything, the architecture used structured JSON for all deterministic operations and reserved AI capabilities for what AI does well &mdash; content transformation, natural language interaction, and adaptive responses.</p>

                <ul class="detail-list">
                    <li><strong>Structured JSON</strong> for course catalog, progress tracking, and state persistence</li>
                    <li><strong>AI code interpreter</strong> for content transformation and dynamic response generation</li>
                    <li><strong>Adaptive Cards</strong> for navigation UI, assessments, and structured learner interactions</li>
                    <li><strong>Copilot Studio topic flows</strong> for conversation orchestration and guardrails</li>
                </ul>

                <p>This hybrid approach solved the reliability challenges of the original declarative design. The AI wasn&rsquo;t fighting its nature trying to be a database &mdash; it was doing what LLMs do best while structured data handled what structured data does best.</p>
            </div>
        </div>
    </section>

    <!-- 4. IMPLEMENTATION -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">4.</span>
                <span class="section-title">Implementation</span>
            </div>

            <table class="resolution-table">
                <thead>
                    <tr>
                        <th style="width: 20%;">Component</th>
                        <th style="width: 30%;">Approach</th>
                        <th style="width: 50%;">Rationale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Component"><strong>Course Catalog</strong></td>
                        <td data-label="Approach">Structured JSON</td>
                        <td data-label="Rationale">Deterministic course structure, sequence, and metadata. No hallucination risk for course content or ordering.</td>
                    </tr>
                    <tr>
                        <td data-label="Component"><strong>Progress Tracking</strong></td>
                        <td data-label="Approach">JSON State Object</td>
                        <td data-label="Rationale">Persists across conversation boundaries. Exact completion status, not LLM approximation.</td>
                    </tr>
                    <tr>
                        <td data-label="Component"><strong>Navigation</strong></td>
                        <td data-label="Approach">Adaptive Cards</td>
                        <td data-label="Rationale">Structured UI buttons enforce valid navigation paths. Users can&rsquo;t accidentally skip or repeat lessons.</td>
                    </tr>
                    <tr>
                        <td data-label="Component"><strong>Assessments</strong></td>
                        <td data-label="Approach">Adaptive Cards + Scoring</td>
                        <td data-label="Rationale">Deterministic scoring with structured answer validation. No LLM interpretation of whether an answer is &ldquo;close enough.&rdquo;</td>
                    </tr>
                    <tr>
                        <td data-label="Component"><strong>Content Delivery</strong></td>
                        <td data-label="Approach">Copilot Studio Topic Flow</td>
                        <td data-label="Rationale">AI code interpreter transforms structured content into natural conversation. The AI handles presentation; the data handles truth.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- 5. OUTCOME -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">5.</span>
                <span class="section-title">Outcome</span>
            </div>
            <div class="background-content">
                <p>Functional proof of concept delivered in <strong>~4 weeks</strong> &mdash; from zero Copilot Studio experience to a working hybrid agent that resolved the reliability and deterministic behavior challenges of the original declarative approach.</p>

                <p>The architecture pattern demonstrated a reusable principle: <strong>hybrid AI/structured-data beats pure LLM for stateful workflows</strong>. This isn&rsquo;t specific to training &mdash; any application requiring deterministic state management (onboarding flows, compliance workflows, sequential processes) benefits from the same separation of concerns.</p>

                <p>The proof of concept was in active development when the engagement concluded.</p>
            </div>

            <div class="probable-cause-box">
                <p><strong>The mistake is treating AI as the data store. AI is the interface to the data store.</strong></p>
                <p>When you separate what needs to be deterministic (state, progress, scores) from what benefits from intelligence (content presentation, adaptive interaction, natural language), you get a system that&rsquo;s both smarter and more reliable than either approach alone.</p>
            </div>

            <div class="impact-tags" class="impact-tags-container">
                <span class="impact-tag highlight">Zero to POC in ~4 Weeks</span>
                <span class="impact-tag highlight">Hybrid AI Architecture</span>
                <span class="impact-tag">Copilot Studio</span>
                <span class="impact-tag">Microsoft Teams</span>
                <span class="impact-tag">Adaptive Cards</span>
                <span class="impact-tag">Deterministic State</span>
                <span class="impact-tag">JSON Data Architecture</span>
                <span class="impact-tag">10-Year Microsoft Relationship</span>
            </div>
        </div>
    </section>

    <!-- 6. TECHNOLOGIES -->
    <section class="report-section">
        <div class="container">
            <div class="section-heading">
                <span class="section-number">6.</span>
                <span class="section-title">Technologies</span>
            </div>

            <table class="resolution-table">
                <thead>
                    <tr>
                        <th style="width: 30%;">Category</th>
                        <th style="width: 70%;">Technologies & Tools</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Category"><strong>Microsoft AI Platform</strong></td>
                        <td data-label="Technologies & Tools">Microsoft Copilot Studio (topic-based conversation design, AI code interpreter, orchestration flows), Azure OpenAI Service (GPT models for content transformation), Microsoft Teams (native integration, user interface)</td>
                    </tr>
                    <tr>
                        <td data-label="Category"><strong>Data Architecture</strong></td>
                        <td data-label="Technologies & Tools">Structured JSON (course catalog, progress tracking, state persistence), Deterministic state management (cross-conversation boundary persistence), Session state objects (completion status, assessment scores)</td>
                    </tr>
                    <tr>
                        <td data-label="Category"><strong>User Interface</strong></td>
                        <td data-label="Technologies & Tools">Adaptive Cards (navigation UI, assessment forms, structured learner interactions), Teams Messaging Extensions (conversation-based training delivery)</td>
                    </tr>
                    <tr>
                        <td data-label="Category"><strong>AI Integration Patterns</strong></td>
                        <td data-label="Technologies & Tools">Hybrid AI/structured-data architecture (AI for presentation, JSON for truth), AI code interpreter (content transformation, dynamic response generation), LLM guardrails (topic flow constraints, deterministic navigation enforcement)</td>
                    </tr>
                    <tr>
                        <td data-label="Category"><strong>Development Approach</strong></td>
                        <td data-label="Technologies & Tools">Zero Copilot Studio experience baseline (learning technology domain knowledge, engineering methodology transfer), R&D experimentation (component design, variable testing, flow iteration), Proof-of-concept delivery (~4 weeks from zero to functional)</td>
                    </tr>
                    <tr>
                        <td data-label="Category"><strong>Microsoft Engagement History</strong></td>
                        <td data-label="Technologies & Tools">10-year relationship (GP Strategies embedded staff since 2015), Windows 10 eLearning program contribution, SCORM integration troubleshooting, Accessibility initiative ("moving the bar to better, more accessible courses")</td>
                    </tr>
                </tbody>
            </table>

            <div class="background-content">
                <h3>Architectural Pattern Innovation</h3>
                <p>The hybrid AI/structured-data pattern demonstrated: <strong>structured data for state, AI for interaction</strong>. Instead of asking the LLM to track everything (probabilistic, hallucination-prone), the architecture separated concerns:</p>
                <ul class="detail-list">
                    <li><strong>Deterministic Operations (JSON):</strong> Course catalog, progress tracking, assessment scoring, navigation paths—anything requiring exact, repeatable results</li>
                    <li><strong>Intelligence Operations (AI):</strong> Content transformation, natural language interaction, adaptive response generation—where LLM capabilities add value without risking data integrity</li>
                    <li><strong>Orchestration Layer (Copilot Studio):</strong> Topic flows enforce conversation guardrails, prevent LLM drift, and ensure users can't accidentally skip required content</li>
                </ul>
                <p>This pattern isn't specific to training—any stateful workflow (onboarding, compliance, sequential processes) benefits from separating what needs determinism from what benefits from intelligence.</p>
            </div>
        </div>
    </section>

    </main>

    <!-- Back Link -->
    <div class="back-link-section">
        <a href="../portfolio.html" class="back-link">
            <span class="arrow">&larr;</span> Back to Portfolio
        </a>
    </div>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <p><strong>Dan Novak</strong> | Senior Software Engineer | Systems Architect</p>
            <p>Portland, OR | <a href="mailto:dan@pattern158.solutions">dan@pattern158.solutions</a> | <a href="https://linkedin.com/in/dan-novak-5692197">LinkedIn</a></p>
            <p class="footer-tagline">Pattern 158: I cheat, but I cheat fair.</p>
        </div>
    </footer>

    <!-- Navigation toggle -->
    <script>
    (function() {
        var hamburger = document.querySelector('.hamburger');
        var navMenu = document.querySelector('.nav-menu');

        if (!hamburger || !navMenu) return;

        function toggleMenu() {
            var isOpen = hamburger.getAttribute('aria-expanded') === 'true';
            var newState = !isOpen;

            hamburger.setAttribute('aria-expanded', String(newState));
            hamburger.classList.toggle('is-active', newState);
            navMenu.classList.toggle('is-open', newState);

            document.body.style.overflow = newState ? 'hidden' : '';
        }

        function closeMenu() {
            hamburger.setAttribute('aria-expanded', 'false');
            hamburger.classList.remove('is-active');
            navMenu.classList.remove('is-open');
            document.body.style.overflow = '';
        }

        hamburger.addEventListener('click', toggleMenu);

        hamburger.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                toggleMenu();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                var isOpen = hamburger.getAttribute('aria-expanded') === 'true';
                if (isOpen) {
                    closeMenu();
                    hamburger.focus();
                }
            }
        });

        document.addEventListener('click', function(e) {
            var isOpen = hamburger.getAttribute('aria-expanded') === 'true';
            if (isOpen && !navMenu.contains(e.target) && !hamburger.contains(e.target)) {
                closeMenu();
            }
        });

        navMenu.addEventListener('click', function(e) {
            if (e.target.tagName === 'A') {
                closeMenu();
            }
        });

        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMenu();
            }
        });
    })();
    </script>

    <script>
    (function() {
        var STORAGE_KEY = 'theme';
        var THEME_ATTR = 'data-theme';
        var toggle = document.getElementById('theme-toggle');
        if (!toggle) return;

        var isDark = document.documentElement.getAttribute(THEME_ATTR) === 'dark';
        toggle.setAttribute('aria-pressed', isDark ? 'true' : 'false');

        toggle.addEventListener('click', function() {
            var html = document.documentElement;
            var currentlyDark = html.getAttribute(THEME_ATTR) === 'dark';
            var newTheme = currentlyDark ? 'light' : 'dark';

            if (newTheme === 'dark') {
                html.setAttribute(THEME_ATTR, 'dark');
            } else {
                html.removeAttribute(THEME_ATTR);
            }

            toggle.setAttribute('aria-pressed', newTheme === 'dark' ? 'true' : 'false');

            try { localStorage.setItem(STORAGE_KEY, newTheme); } catch (e) {}
        });

        window.addEventListener('storage', function(e) {
            if (e.key === STORAGE_KEY) {
                var html = document.documentElement;
                if (e.newValue === 'dark') {
                    html.setAttribute(THEME_ATTR, 'dark');
                    toggle.setAttribute('aria-pressed', 'true');
                } else {
                    html.removeAttribute(THEME_ATTR);
                    toggle.setAttribute('aria-pressed', 'false');
                }
            }
        });

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            try {
                if (localStorage.getItem(STORAGE_KEY) !== null) return;
            } catch (err) {}
            var html = document.documentElement;
            if (e.matches) {
                html.setAttribute(THEME_ATTR, 'dark');
                toggle.setAttribute('aria-pressed', 'true');
            } else {
                html.removeAttribute(THEME_ATTR);
                toggle.setAttribute('aria-pressed', 'false');
            }
        });
    })();
    </script>

</body>
</html>
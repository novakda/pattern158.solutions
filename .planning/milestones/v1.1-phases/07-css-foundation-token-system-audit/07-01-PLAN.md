---
phase: 07-css-foundation-token-system-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - css/main.css
autonomous: true
requirements:
  - CSS-04
  - CSS-07

must_haves:
  truths:
    - "Every font-size declaration in main.css uses a var(--font-size-*) token"
    - "Every hardcoded color outside :root uses a design token"
    - "Font-size token scale covers xs through 5xl with paired line-height tokens"
    - "All hardcoded rem/px spacing values in padding/margin/gap use --space-* tokens (except 0, 0 auto, and structural px values like widths/heights)"
  artifacts:
    - path: "css/main.css"
      provides: "Complete font-size token scale in :root and [data-theme=dark], all 180 hardcoded font-size values migrated"
      contains: "--font-size-xs"
  key_links:
    - from: "css/main.css :root"
      to: "css/main.css selectors"
      via: "var(--font-size-*) references"
      pattern: "font-size:\\s*var\\(--font-size-"
---

<objective>
Define the font-size token scale and migrate all 180 hardcoded font-size values, 3 hardcoded colors, and remaining hardcoded spacing values to design tokens.

Purpose: Establishes complete token coverage (CSS-04) and the font-size scale (CSS-07) that all subsequent v1.1 phases depend on. This is the heaviest migration task -- 180 font-size replacements across 24 unique sizes.

Output: css/main.css with zero hardcoded font-size values, zero hardcoded colors outside :root, and minimal hardcoded spacing.
</objective>

<execution_context>
@/home/xhiris/.claude/get-shit-done/workflows/execute-plan.md
@/home/xhiris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-css-foundation-token-system-audit/07-CONTEXT.md
@.planning/phases/07-css-foundation-token-system-audit/07-RESEARCH.md
@css/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define font-size and line-height token scale in :root</name>
  <files>css/main.css</files>
  <action>
Audit the 24 unique hardcoded font-size values currently in main.css and map them to a font-size token scale. The 24 unique values are:

0.7rem, 0.75rem, 0.8rem, 0.85rem, 0.9rem, 0.9em, 0.95rem, 1rem, 1.05rem, 1.1rem, 1.2rem, 1.25rem, 1.3rem, 1.5rem, 1.6rem, 1.8rem, 2rem, 2.2rem, 2.25rem, 2.5rem, 3rem, 3.5rem, 4rem, 6rem

Define tokens in :root (inside the existing "--- Typography ---" section, after the font-family tokens) following this approach:
- Use t-shirt naming: --font-size-xs, --font-size-sm, --font-size-base, --font-size-md, --font-size-lg, --font-size-xl, --font-size-2xl, --font-size-3xl, --font-size-4xl, --font-size-5xl
- Map nearby hardcoded values to the same token where the visual difference is negligible (e.g., 0.9rem and 0.95rem can both map to --font-size-sm if appropriate)
- Define paired --line-height-* tokens for each font-size to prevent typography bugs
- Keep the 0.9em value for code blocks as-is (relative to parent, not a fixed size) -- this is the one exception
- Add a comment block above the tokens listing which hardcoded values map to which token

Also add a --color-danger token (value: #dc3545) to the Colors section in :root, and its dark mode equivalent in [data-theme="dark"]. This covers the 3 hardcoded #dc3545 references on lines ~2401, 2559, 2560.

Do NOT change any selectors or property values yet -- only add the new token definitions.
  </action>
  <verify>
Grep for "--font-size-" in :root section confirms 8-12 font-size tokens defined.
Grep for "--line-height-" confirms paired line-height tokens.
Grep for "--color-danger" confirms danger color token.
The file still has 180 hardcoded font-size values (migration happens in Task 2).
  </verify>
  <done>Font-size token scale (xs through 5xl) with paired line-heights defined in :root and dark mode section. Danger color token defined.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate all hardcoded values to design tokens</name>
  <files>css/main.css</files>
  <action>
Replace ALL 180 hardcoded font-size declarations with var(--font-size-*) references using the mapping established in Task 1. For each replacement, also add the paired line-height token where one is not already specified.

Additionally:
1. Replace the 3 instances of #dc3545 (lines ~2401, 2559, 2560) with var(--color-danger).
2. Audit all padding/margin/gap values that use raw rem/px numbers and replace with --space-* tokens where a close match exists. Exceptions that should NOT be tokenized:
   - Values of 0, 0 auto (structural resets)
   - Width/height/min-width/min-height/max-width values (dimensional, not spacing)
   - Positioning values (top, left, right, bottom)
   - Border widths (1px, 2px, 3px, 4px, 6px -- these are too specific)
   - The 0.8rem in .btn padding (already uses mixed token+hardcoded -- replace the 0.8rem portion with closest --space-* token)
   - Hamburger menu structural px values (28px, 24px, 3px, 8px -- these are precise component dimensions)

For spacing values like "padding: 12px 24px" (skip-link), convert to token equivalents: padding: var(--space-md) var(--space-xl).

For the "margin-top: 2.5rem" on line 1464 (.page-testimonials .stats-bar), use var(--space-2xl) or var(--space-3xl) as closest match.

Work through the file section by section (Design Tokens > Reset > Base > Accessibility > Navigation > Layout > Footer > Components > Page sections > Responsive). Be thorough -- every font-size must use a token.
  </action>
  <verify>
Run: grep -cP 'font-size:\s*\d' css/main.css -- should return 0 (except the 0.9em for code which uses 'em' not 'rem').
Run: grep -cP '#dc3545' css/main.css -- should return 0.
Run: grep -cP 'font-size:\s*var\(--font-size' css/main.css -- should return approximately 180.
Open the site in a browser and visually spot-check index.html, portfolio.html, and one exhibit page to confirm no visual regressions.
  </verify>
  <done>Zero hardcoded font-size values remain (except code block 0.9em). Zero hardcoded colors outside :root. Hardcoded spacing significantly reduced. All font-size declarations use var(--font-size-*) tokens.</done>
</task>

</tasks>

<verification>
1. `grep -cP 'font-size:\s*[0-9]' css/main.css` returns 1 (only the 0.9em code exception) or 0
2. `grep -cP '#[0-9a-fA-F]{3,8}' css/main.css` -- all matches are inside :root or [data-theme="dark"] blocks only
3. `grep -c 'var(--font-size-' css/main.css` returns ~180 (confirming migration)
4. CSS file parses without syntax errors (open in browser, check DevTools console)
</verification>

<success_criteria>
- Font-size token scale defined with --font-size-xs through --font-size-5xl
- Paired line-height tokens defined for each font-size
- All 180 hardcoded font-size values replaced with var(--font-size-*) tokens
- All 3 hardcoded #dc3545 colors replaced with var(--color-danger)
- Hardcoded spacing values reduced to structural-only exceptions
- No visual regressions on any page
</success_criteria>

<output>
After completion, create `.planning/phases/07-css-foundation-token-system-audit/07-01-SUMMARY.md`
</output>

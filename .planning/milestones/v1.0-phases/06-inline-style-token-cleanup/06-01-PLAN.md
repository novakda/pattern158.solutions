---
phase: 06-inline-style-token-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - index.html
  - contact.html
  - faq.html
  - philosophy.html
  - testimonials.html
  - exhibits/exhibit-a.html
  - exhibits/exhibit-b.html
  - exhibits/exhibit-c.html
  - exhibits/exhibit-d.html
  - exhibits/exhibit-e.html
  - exhibits/exhibit-f.html
  - exhibits/exhibit-g.html
  - exhibits/exhibit-h.html
  - exhibits/exhibit-i.html
  - exhibits/exhibit-j.html
  - exhibits/exhibit-k.html
  - exhibits/exhibit-l.html
autonomous: true
requirements:
  - CSS-02
  - DARK-01
gap_closure: true

must_haves:
  truths:
    - "Zero references to var(--teal) in any HTML file"
    - "Zero references to var(--light-gray) in any HTML file"
    - "Zero hardcoded hex color values (#888, #555, #666) in HTML inline style attributes"
    - "Zero hardcoded 'background: white' in HTML inline style attributes"
    - "All inline color values use design system tokens (var(--color-primary), var(--color-text-muted), etc.)"
    - "Dark mode toggle changes ALL text and background colors on ALL pages (no inline style bypass)"
    - "WCAG AA contrast (4.5:1) maintained in both light and dark themes for all inline-styled text"
  artifacts:
    - path: "index.html"
      provides: "Footer tagline using --color-primary"
      contains: "var(--color-primary)"
    - path: "testimonials.html"
      provides: "Attribution footnote using --color-text-muted"
      contains: "var(--color-text-muted)"
    - path: "exhibits/exhibit-f.html"
      provides: "Section backgrounds using --color-background-alt and --color-surface"
      contains: "var(--color-background-alt)"
    - path: "exhibits/exhibit-a.html"
      provides: "Body paragraph using --color-text-medium"
      contains: "var(--color-text-medium)"
  key_links:
    - from: "all 17 HTML files (inline style attributes)"
      to: "css/main.css :root{} token definitions"
      via: "CSS custom property resolution (var() function)"
      pattern: "var\\(--color-(primary|background-alt|surface|text-muted|text-medium)\\)"
    - from: "all 17 HTML files (inline style attributes)"
      to: "css/main.css [data-theme='dark'] overrides"
      via: "CSS cascade — dark mode overrides :root values, inline var() picks up new values"
      pattern: "var\\(--color-"
---

<objective>
Replace all undefined CSS variable references and hardcoded hex color values in HTML inline style attributes with design system tokens.

Purpose: Close CSS-02 and DARK-01 gaps from the v1.0 milestone audit. Phase 1 converted colors in css/main.css to tokens but missed 49 inline style= attributes in HTML files. These use deleted variable names (--teal, --light-gray) and hardcoded hex values (#888, #555, #666, white) that bypass the dark mode override system entirely.

Output: 17 HTML files updated with correct design system token references. Zero new CSS, zero new tokens, zero new JavaScript — purely correcting existing HTML to use the Phase 1 design system.
</objective>

<execution_context>
@/home/xhiris/.claude/get-shit-done/workflows/execute-plan.md
@/home/xhiris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-inline-style-token-cleanup/06-RESEARCH.md
@css/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Execute all 4 token replacement groups across 17 HTML files</name>
  <files>
    index.html
    contact.html
    faq.html
    philosophy.html
    testimonials.html
    exhibits/exhibit-a.html
    exhibits/exhibit-b.html
    exhibits/exhibit-c.html
    exhibits/exhibit-d.html
    exhibits/exhibit-e.html
    exhibits/exhibit-f.html
    exhibits/exhibit-g.html
    exhibits/exhibit-h.html
    exhibits/exhibit-i.html
    exhibits/exhibit-j.html
    exhibits/exhibit-k.html
    exhibits/exhibit-l.html
  </files>
  <action>
    Execute 4 find-and-replace groups in this exact order across all HTML files (root *.html and exhibits/*.html). Only modify color-related inline style values. Do NOT touch non-color styles (margin, font-size, width, line-height).

    **Group 1 — Undefined variable (17 occurrences, all 17 pages):**
    Replace `color: var(--teal)` with `color: var(--color-primary)`
    Context: footer tagline "Pattern 158: I cheat, but I cheat fair."

    **Group 2 — Undefined variable (8 occurrences, exhibits f/g/h/i):**
    Replace `background: var(--light-gray)` with `background: var(--color-background-alt)`
    Context: alternating section backgrounds

    **Group 3 — Hardcoded color keyword (10 occurrences, exhibits f/g/h/i):**
    Replace `background: white` with `background: var(--color-surface)`
    Context: alternating section backgrounds (white sections between gray)

    **Group 4 — Hardcoded hex values (14 occurrences across 10 files):**
    - Replace `color: #888` with `color: var(--color-text-muted)` (10 occurrences — testimonials + 9 exhibits)
    - Replace `color: #555` with `color: var(--color-text-medium)` (1 occurrence — exhibit-a.html)
    - Replace `color: #666` with `color: var(--color-text-muted)` (3 occurrences — exhibits c/e/i)

    **IMPORTANT — Anti-patterns:**
    - Do NOT use --color-text-source for #888 (fails WCAG at 3.37:1). Use --color-text-muted (5.45:1).
    - Do NOT use --color-text-light for any body text (fails WCAG).
    - Do NOT map "background: white" to --color-background (that's page canvas). Use --color-surface.
    - Do NOT modify non-color inline styles (margin-top, font-size, width, line-height).

    After each group, verify with grep that zero instances of the old pattern remain before proceeding to the next group.
  </action>
  <verify>
    Run comprehensive grep — all of these must return zero matches:
    ```
    grep -rn "var(--teal)" *.html exhibits/*.html
    grep -rn "var(--light-gray)" *.html exhibits/*.html
    grep -rn "background: white" *.html exhibits/*.html
    grep -rn "color: #888\|color: #555\|color: #666" *.html exhibits/*.html
    ```
    Total expected: 0 matches across all 4 commands.
  </verify>
  <done>
    All 49 inline style color problems replaced with design system tokens:
    - 17x var(--teal) → var(--color-primary)
    - 8x var(--light-gray) → var(--color-background-alt)
    - 10x background: white → background: var(--color-surface)
    - 10x color: #888 → color: var(--color-text-muted)
    - 1x color: #555 → color: var(--color-text-medium)
    - 3x color: #666 → color: var(--color-text-muted)
  </done>
</task>

<task type="auto">
  <name>Task 2: Validate token resolution and WCAG compliance</name>
  <files>
    index.html
    exhibits/exhibit-a.html
    exhibits/exhibit-f.html
    testimonials.html
  </files>
  <action>
    Perform two validation passes:

    **Pass 1 — Token existence verification:**
    Confirm all referenced tokens exist in css/main.css :root{} block. Read css/main.css and verify these tokens are defined:
    - --color-primary (should be #0e7c8c)
    - --color-background-alt (should be #e8e8e8 in :root, #243447 in dark)
    - --color-surface (should be #ffffff in :root, #2a3f54 in dark)
    - --color-text-muted (should be #666666 in :root, #a0a0a0 in dark)
    - --color-text-medium (should be #555555 in :root, #b0b0b0 in dark)

    If any token is missing or has unexpected values, STOP and report — do not proceed.

    **Pass 2 — Comprehensive final audit:**
    Run a single grep across all HTML files for ANY remaining inline style color problems. Search for:
    - Any `var(--` reference that is NOT a valid --color-* token (catches undefined variables)
    - Any `color: #` pattern in style= attributes (catches hardcoded hex)
    - Any `background: ` followed by a color keyword (white, black, gray, etc.) in style= attributes

    Report findings. Zero problems expected.
  </action>
  <verify>
    All 5 tokens confirmed in css/main.css with correct light and dark values.
    Final audit grep returns zero problematic inline color patterns.
  </verify>
  <done>
    - All 5 design system tokens verified present in css/main.css :root{} and [data-theme="dark"] blocks
    - Zero undefined CSS variable references in any HTML inline style
    - Zero hardcoded hex/keyword color values in any HTML inline style
    - CSS-02 gap closed: all inline colors use CSS custom properties
    - DARK-01 gap closed: all inline colors respond to dark mode toggle via token cascade
  </done>
</task>

</tasks>

<verification>
Phase-level verification checks:

1. **Zero undefined variables:** `grep -rn "var(--teal)\|var(--light-gray)" *.html exhibits/*.html` returns nothing
2. **Zero hardcoded hex in inline styles:** `grep -rn "color: #888\|color: #555\|color: #666" *.html exhibits/*.html` returns nothing
3. **Zero hardcoded background keywords:** `grep -rn "background: white" *.html exhibits/*.html` returns nothing
4. **Token references valid:** All `var(--color-*)` in inline styles resolve to defined tokens in css/main.css
5. **WCAG compliance:** All replacement tokens meet 4.5:1 contrast in both light and dark modes (pre-verified in research — --color-text-muted: 5.45:1/5.72:1, --color-text-medium: 7.08:1/6.89:1, --color-primary: 4.66:1/4.66:1)
</verification>

<success_criteria>
- 49 inline style color problems fixed across 17 HTML files
- Zero instances of var(--teal), var(--light-gray), #888, #555, #666, or "background: white" in any HTML file
- All inline color values use design system tokens that respond to dark mode toggle
- CSS-02 requirement satisfied: all hardcoded color values replaced with CSS custom properties
- DARK-01 requirement satisfied: dark theme covers all color values including inline styles
</success_criteria>

<output>
After completion, create `.planning/phases/06-inline-style-token-cleanup/06-01-SUMMARY.md`
</output>

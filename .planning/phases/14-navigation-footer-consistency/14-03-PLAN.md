---
phase: 14-navigation-footer-consistency
plan: 03
type: execute
wave: 1
depends_on: []
files_modified: [css/main.css]
autonomous: true
gap_closure: true
requirements: [NAV-05, NAV-06, NAV-07]

must_haves:
  truths:
    - "Mobile active state styling uses CSS variable instead of hardcoded rgba value"
    - "All active state styling (desktop and mobile) uses design tokens exclusively"
    - "Dark mode mobile active state adapts correctly via CSS variable override"
  artifacts:
    - path: "css/main.css"
      provides: "CSS variable for primary color with alpha transparency"
      contains: "--color-primary-subtle"
  key_links:
    - from: "css/main.css :root"
      to: "css/main.css mobile active state rule"
      via: "CSS variable reference"
      pattern: "var\\(--color-primary-subtle\\)"
---

<objective>
Replace the hardcoded `rgba(14, 124, 140, 0.15)` in the mobile active state with a CSS variable to close the design token compliance gap from Phase 14 verification.

Purpose: Ensure 100% design token usage across all Phase 14 changes — the mobile navigation active state background is the sole remaining hardcoded color value introduced in this phase.

Output: Updated css/main.css with new `--color-primary-subtle` variable and mobile active state referencing it.
</objective>

<execution_context>
@/home/xhiris/.claude/get-shit-done/workflows/execute-plan.md
@/home/xhiris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/14-navigation-footer-consistency/14-VERIFICATION.md
@css/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add primary-subtle CSS variable and replace hardcoded mobile active state color</name>
  <files>css/main.css</files>
  <action>
    1. In the `:root` block, after `--color-border-primary: rgba(14, 124, 140, 0.3);` (line 33), add a new variable:
       `--color-primary-subtle: rgba(14, 124, 140, 0.15);  /* Primary with 15% alpha for subtle backgrounds */`

    2. In the `[data-theme="dark"]` block, after `--color-border-primary: rgba(14, 124, 140, 0.4);` (line 136), add the dark mode override:
       `--color-primary-subtle: rgba(30, 163, 181, 0.15);  /* Dark mode primary (#1ea3b5) with 15% alpha */`
       Note: Dark mode uses the lightened primary `#1ea3b5` which is `rgb(30, 163, 181)`, so the alpha variant must use the same base color for consistency.

    3. In the mobile responsive section (around line 3106), replace:
       `background: rgba(14, 124, 140, 0.15);`
       with:
       `background: var(--color-primary-subtle);`

    Naming rationale: "subtle" follows the pattern of semantic names (like `--color-text-muted`, `--color-text-light`) rather than encoding the alpha value in the name (avoid `--color-primary-alpha-15`). This variable describes its PURPOSE (subtle background tint) not its implementation (15% alpha).
  </action>
  <verify>
    1. Run: `grep -n 'color-primary-subtle' css/main.css` — should show 3 matches: :root definition, dark mode override, and mobile active state usage
    2. Run: `grep -n 'rgba(14, 124, 140, 0.15)' css/main.css` — should show 0 matches (hardcoded value eliminated)
    3. Run: `grep -c 'rgba(14, 124, 140' css/main.css` — count remaining hardcoded primary-color rgba values; all should be within :root or [data-theme="dark"] variable definitions, not in component rules
  </verify>
  <done>
    - New `--color-primary-subtle` CSS variable defined in both `:root` and `[data-theme="dark"]`
    - Mobile active state background uses `var(--color-primary-subtle)` instead of hardcoded rgba
    - Zero hardcoded primary-color rgba values remain outside of CSS variable definitions
    - Dark mode override uses the lightened primary (#1ea3b5 base) for proper theme adaptation
  </done>
</task>

</tasks>

<verification>
1. No hardcoded `rgba(14, 124, 140, 0.15)` remains in component rules (only in :root variable definition)
2. Mobile active state renders identically in light mode (same visual result, now via variable)
3. Dark mode mobile active state uses lightened primary color (adapts with theme)
4. All Phase 14 VERIFICATION.md truths now pass (12/12 instead of 11/12 + 1 partial)
</verification>

<success_criteria>
- `grep 'rgba(14, 124, 140, 0.15)' css/main.css` returns zero matches outside :root
- `grep 'var(--color-primary-subtle)' css/main.css` returns match in mobile active state rule
- All hardcoded primary-color rgba values are confined to CSS variable definitions
</success_criteria>

<output>
After completion, create `.planning/phases/14-navigation-footer-consistency/14-03-SUMMARY.md`
</output>
